branchCanvas=function(t){if(t||(t={}),!t.container)throw"!opts.container";if(!t.data)throw"!opts.data";t.dtFontSize=t.dtFontSize?t.dtFontSize:11,t.textFontSize=t.textFontSize?t.textFontSize:15,this.radius=t.radius?t.radius:13,this.margin=t.margin?t.margin:10,this.font=t.font?t.font:"Meiryo,Koruri,Arial",this.dtFontSize="number"==typeof t.dtFontSize?t.dtFontSize+"px":t.dtFontSize,this.textFontSize="number"==typeof t.textFontSize?t.textFontSize+"px":t.textFontSize,this.data=t.data,this.canvas=t.container.appendChild(document.createElement("canvas")),this.ctx=this.canvas.getContext("2d"),this.canvas.height=this.draw()},branchCanvas.prototype._calcBx=function(t){return this.margin+2*this.radius*t-this.radius},branchCanvas.prototype.draw=function(){let t=this,i=null,a=-t.radius,e=Math.max(...t.data.map(t=>t.depth)),n=[...new Array(e)].map(t=>null);t.ctx.textBaseline="top",t.ctx.beginPath();for(let r=0,o=t.data.length;r<o;r++){let o=t.data[r],d=t._calcBx(o.depth);if(a+=2*(t.radius+t.margin/2),null!==i&&i!==o.depth){let e;i<o.depth?e=d-2*t.radius:(e=d+2*t.radius,n[o.depth]=null),t.ctx.moveTo(e,a-t.margin-t.radius),t.ctx.bezierCurveTo(e,a-t.radius+t.margin,d,a-t.radius-t.margin,d,a-t.radius+t.margin),a+=t.margin}null!==n[o.depth-1]&&(t.ctx.moveTo(d,n[o.depth-1]),t.ctx.lineTo(d,a-t.radius)),t.ctx.moveTo(d+t.radius,a),t.ctx.arc(d,a,t.radius,0,2*Math.PI,!1),t.ctx.font=t.dtFontSize+" "+t.font,t.ctx.fillStyle="#888",t.ctx.fillText(o.datetime,t._calcBx(e)+t.radius+t.margin,a-t.radius),t.ctx.font=t.textFontSize+" "+t.font,t.ctx.fillStyle="#333",t.ctx.fillText(o.text,t._calcBx(e)+t.radius+t.margin,a-t.radius+13),i=o.depth,n[o.depth-1]=a+t.radius}return t.ctx.stroke(),a+t.radius+t.margin};